<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 600">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#22c55e"/>
    </marker>
    <marker id="arrowhead-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3b82f6"/>
    </marker>
    <linearGradient id="flyGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6"/>
      <stop offset="100%" style="stop-color:#6366f1"/>
    </linearGradient>
    <linearGradient id="awsGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ff9900"/>
      <stop offset="100%" style="stop-color:#ec7211"/>
    </linearGradient>
    <linearGradient id="wgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#22c55e"/>
      <stop offset="100%" style="stop-color:#16a34a"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="900" height="600" fill="#0f172a"/>

  <!-- Title -->
  <text x="450" y="35" text-anchor="middle" fill="#f8fafc" font-family="Inter, system-ui, sans-serif" font-size="20" font-weight="bold">AWS RDS via WireGuard - Arquitetura</text>

  <!-- Internet Cloud -->
  <ellipse cx="450" cy="90" rx="120" ry="30" fill="#1e293b" stroke="#475569" stroke-width="2"/>
  <text x="450" y="95" text-anchor="middle" fill="#94a3b8" font-family="Inter, system-ui, sans-serif" font-size="14">Internet</text>

  <!-- Fly.io Box -->
  <rect x="50" y="160" width="250" height="180" rx="12" fill="#1e1b4b" stroke="#8b5cf6" stroke-width="2"/>
  <rect x="50" y="160" width="250" height="35" rx="12" fill="url(#flyGradient)"/>
  <text x="175" y="183" text-anchor="middle" fill="white" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="bold">Fly.io (LHR)</text>

  <!-- Fly.io App -->
  <rect x="70" y="210" width="210" height="110" rx="8" fill="#312e81" stroke="#6366f1" stroke-width="1"/>
  <text x="175" y="235" text-anchor="middle" fill="#c7d2fe" font-family="Inter, system-ui, sans-serif" font-size="12" font-weight="bold">contacts-api</text>
  <text x="175" y="255" text-anchor="middle" fill="#a5b4fc" font-family="monospace" font-size="11">Go + lib/pq</text>

  <!-- WireGuard interface on Fly -->
  <rect x="90" y="270" width="170" height="40" rx="6" fill="#166534" stroke="#22c55e" stroke-width="1"/>
  <text x="175" y="285" text-anchor="middle" fill="#bbf7d0" font-family="monospace" font-size="10">wg0: 10.50.3.10/32</text>
  <text x="175" y="300" text-anchor="middle" fill="#86efac" font-family="monospace" font-size="9">peer: EC2 Hub</text>

  <!-- AWS VPC Box -->
  <rect x="400" y="160" width="450" height="400" rx="12" fill="#1c1917" stroke="#f97316" stroke-width="2"/>
  <rect x="400" y="160" width="450" height="35" rx="12" fill="url(#awsGradient)"/>
  <text x="625" y="183" text-anchor="middle" fill="white" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="bold">AWS VPC (eu-west-1) - 172.31.0.0/16</text>

  <!-- EC2 Hub Box -->
  <rect x="420" y="210" width="200" height="200" rx="8" fill="#292524" stroke="#fbbf24" stroke-width="1"/>
  <text x="520" y="235" text-anchor="middle" fill="#fef3c7" font-family="Inter, system-ui, sans-serif" font-size="12" font-weight="bold">EC2 Hub (t3.micro)</text>
  <text x="520" y="252" text-anchor="middle" fill="#fde68a" font-family="monospace" font-size="10">34.240.78.199</text>

  <!-- WireGuard interface on EC2 -->
  <rect x="435" y="265" width="170" height="40" rx="6" fill="#166534" stroke="#22c55e" stroke-width="1"/>
  <text x="520" y="280" text-anchor="middle" fill="#bbf7d0" font-family="monospace" font-size="10">wg0: 10.50.0.1/24</text>
  <text x="520" y="295" text-anchor="middle" fill="#86efac" font-family="monospace" font-size="9">ListenPort: 51820</text>

  <!-- iptables NAT Box -->
  <rect x="435" y="315" width="170" height="85" rx="6" fill="#7f1d1d" stroke="#ef4444" stroke-width="1"/>
  <text x="520" y="332" text-anchor="middle" fill="#fecaca" font-family="Inter, system-ui, sans-serif" font-size="10" font-weight="bold">iptables NAT</text>
  <text x="520" y="350" text-anchor="middle" fill="#fca5a5" font-family="monospace" font-size="8">PREROUTING DNAT</text>
  <text x="520" y="365" text-anchor="middle" fill="#fca5a5" font-family="monospace" font-size="8">:5432 → RDS:5432</text>
  <text x="520" y="382" text-anchor="middle" fill="#fca5a5" font-family="monospace" font-size="8">POSTROUTING MASQ</text>

  <!-- RDS Box -->
  <rect x="650" y="340" width="180" height="120" rx="8" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="740" y="365" text-anchor="middle" fill="#93c5fd" font-family="Inter, system-ui, sans-serif" font-size="12" font-weight="bold">RDS PostgreSQL</text>
  <text x="740" y="385" text-anchor="middle" fill="#60a5fa" font-family="monospace" font-size="10">db.t3.micro</text>
  <text x="740" y="405" text-anchor="middle" fill="#60a5fa" font-family="monospace" font-size="10">172.31.3.134:5432</text>
  <text x="740" y="425" text-anchor="middle" fill="#60a5fa" font-family="monospace" font-size="9">contacts database</text>
  <text x="740" y="445" text-anchor="middle" fill="#60a5fa" font-family="monospace" font-size="9">500 registros</text>

  <!-- Security Groups -->
  <rect x="420" y="480" width="200" height="60" rx="6" fill="#0f172a" stroke="#64748b" stroke-width="1" stroke-dasharray="4"/>
  <text x="520" y="500" text-anchor="middle" fill="#94a3b8" font-family="Inter, system-ui, sans-serif" font-size="10">Security Group</text>
  <text x="520" y="515" text-anchor="middle" fill="#64748b" font-family="monospace" font-size="9">UDP 51820, TCP 22</text>
  <text x="520" y="530" text-anchor="middle" fill="#64748b" font-family="monospace" font-size="9">sg-06b10b1222b9f530f</text>

  <rect x="650" y="480" width="180" height="60" rx="6" fill="#0f172a" stroke="#64748b" stroke-width="1" stroke-dasharray="4"/>
  <text x="740" y="500" text-anchor="middle" fill="#94a3b8" font-family="Inter, system-ui, sans-serif" font-size="10">Security Group</text>
  <text x="740" y="515" text-anchor="middle" fill="#64748b" font-family="monospace" font-size="9">TCP 5432</text>
  <text x="740" y="530" text-anchor="middle" fill="#64748b" font-family="monospace" font-size="9">sg-06ad37f4e3ef49d7c</text>

  <!-- WireGuard Tunnel -->
  <path d="M 300 290 C 350 290, 350 285, 435 285" stroke="#22c55e" stroke-width="3" fill="none" marker-end="url(#arrowhead-green)" stroke-dasharray="8,4"/>
  <rect x="320" y="260" width="90" height="25" rx="4" fill="#166534"/>
  <text x="365" y="277" text-anchor="middle" fill="#bbf7d0" font-family="monospace" font-size="9">WireGuard</text>

  <!-- NAT to RDS Arrow -->
  <path d="M 605 365 L 650 390" stroke="#3b82f6" stroke-width="2" fill="none" marker-end="url(#arrowhead-blue)"/>
  <text x="630" y="355" text-anchor="middle" fill="#60a5fa" font-family="monospace" font-size="9">NAT</text>

  <!-- Internet to Fly -->
  <line x1="380" y1="105" x2="175" y2="155" stroke="#475569" stroke-width="1" marker-end="url(#arrowhead)"/>

  <!-- Internet to EC2 -->
  <line x1="520" y1="105" x2="520" y2="155" stroke="#475569" stroke-width="1" marker-end="url(#arrowhead)"/>

  <!-- Legend -->
  <rect x="50" y="520" width="300" height="60" rx="8" fill="#1e293b" stroke="#334155" stroke-width="1"/>
  <text x="70" y="540" fill="#f8fafc" font-family="Inter, system-ui, sans-serif" font-size="11" font-weight="bold">Legenda:</text>
  <line x1="70" y1="555" x2="100" y2="555" stroke="#22c55e" stroke-width="3" stroke-dasharray="8,4"/>
  <text x="110" y="559" fill="#94a3b8" font-family="Inter, system-ui, sans-serif" font-size="10">Túnel WireGuard (criptografado)</text>
  <line x1="230" y1="555" x2="260" y2="555" stroke="#3b82f6" stroke-width="2"/>
  <text x="270" y="559" fill="#94a3b8" font-family="Inter, system-ui, sans-serif" font-size="10">NAT interno</text>
</svg>