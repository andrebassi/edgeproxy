<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 400">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="600" height="400" fill="#f8fafc"/>

  <!-- Title -->
  <text x="300" y="30" text-anchor="middle" font-family="system-ui, sans-serif" font-size="18" font-weight="bold" fill="#1e293b">Graceful Shutdown Flow</text>

  <!-- Step 1: Signal -->
  <rect x="40" y="60" width="120" height="50" rx="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
  <text x="100" y="90" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" fill="#92400e">SIGTERM / Ctrl+C</text>

  <!-- Arrow 1 -->
  <line x1="160" y1="85" x2="200" y2="85" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Step 2: Stop accepting -->
  <rect x="210" y="60" width="140" height="50" rx="8" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/>
  <text x="280" y="82" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" fill="#991b1b">Stop Accepting</text>
  <text x="280" y="96" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" fill="#991b1b">New Connections</text>

  <!-- Arrow 2 -->
  <line x1="350" y1="85" x2="390" y2="85" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Step 3: Drain -->
  <rect x="400" y="60" width="160" height="50" rx="8" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
  <text x="480" y="82" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" fill="#1e40af">Wait for Active</text>
  <text x="480" y="96" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" fill="#1e40af">Connections to Drain</text>

  <!-- Active Connections Box -->
  <rect x="150" y="150" width="300" height="120" rx="8" fill="#f1f5f9" stroke="#94a3b8" stroke-width="1"/>
  <text x="300" y="175" text-anchor="middle" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="#475569">Active Connections</text>

  <!-- Connection icons -->
  <circle cx="200" cy="210" r="15" fill="#22c55e" stroke="#16a34a" stroke-width="2"/>
  <text x="200" y="215" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="white">C1</text>

  <circle cx="260" cy="210" r="15" fill="#22c55e" stroke="#16a34a" stroke-width="2"/>
  <text x="260" y="215" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="white">C2</text>

  <circle cx="320" cy="210" r="15" fill="#f59e0b" stroke="#d97706" stroke-width="2"/>
  <text x="320" y="215" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="white">C3</text>

  <circle cx="380" cy="210" r="15" fill="#ef4444" stroke="#dc2626" stroke-width="2"/>
  <text x="380" y="215" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="white">C4</text>

  <!-- Legend -->
  <circle cx="180" cy="250" r="8" fill="#22c55e"/>
  <text x="195" y="254" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Completed</text>

  <circle cx="280" cy="250" r="8" fill="#f59e0b"/>
  <text x="295" y="254" font-family="system-ui, sans-serif" font-size="10" fill="#475569">In Progress</text>

  <circle cx="380" cy="250" r="8" fill="#ef4444"/>
  <text x="395" y="254" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Force Close</text>

  <!-- Arrow to decision -->
  <line x1="300" y1="270" x2="300" y2="300" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Decision Diamond -->
  <polygon points="300,310 360,340 300,370 240,340" fill="#e0e7ff" stroke="#6366f1" stroke-width="2"/>
  <text x="300" y="344" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#4338ca">Timeout?</text>

  <!-- No path -->
  <line x1="240" y1="340" x2="100" y2="340" stroke="#666" stroke-width="2"/>
  <line x1="100" y1="340" x2="100" y2="200" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="170" y="330" font-family="system-ui, sans-serif" font-size="10" fill="#475569">No - Keep waiting</text>

  <!-- Yes path -->
  <line x1="360" y1="340" x2="500" y2="340" stroke="#666" stroke-width="2"/>
  <text x="420" y="330" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Yes</text>

  <!-- Exit box -->
  <rect x="500" y="315" width="80" height="50" rx="8" fill="#dcfce7" stroke="#22c55e" stroke-width="2"/>
  <text x="540" y="345" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" fill="#166534">Exit 0</text>
</svg>
